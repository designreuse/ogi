<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report1" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="9a11e1e2-d0c2-4943-8003-0108fa505071">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="net.sf.jasperreports.export.character.encoding" value="UTF-8"/>
	<subDataset name="dataset1" uuid="cf76163f-1bb4-4800-aaba-ca80cffda3cf"/>
	<parameter name="reference" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["D:\\Developpement\\Master\\Java7\\workspace\\ogi\\ogi-parent\\ogi-services\\src\\main\\jasperreports\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="ROOT_DIR" class="java.lang.String"/>
	<parameter name="DOC_DIR" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
     prp.`PRO_REFERENCE` AS PRO_REFERENCE,
     ta_address.`ADD_CITY` AS ADD_CITY,
     sale.`SAL_MAND_REFERENCE` AS SAL_MAND_REFERENCE,
     IFNULL(sale.`SAL_PRICE`, 0) + IFNULL(sale.`SAL_COMMISSION`, 0) AS PRIX,
	 DESCRIPTION.DSC_LABEL
FROM
	`ta_property` prp
     LEFT JOIN ta_address ON ta_address.`ADD_ID` = prp.`ADD_ID`
     LEFT JOIN `ta_sale` sale ON sale.PRO_ID = prp.`PRO_ID`
	 LEFT JOIN TA_DESCRIPTION DESCRIPTION ON DESCRIPTION.PRO_ID=PRP.PRO_ID AND DESCRIPTION.DSC_TYPE='APP'
WHERE
     prp.`PRO_REFERENCE` = $P{reference}]]>
	</queryString>
	<field name="PRO_REFERENCE" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ADD_CITY" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="SAL_MAND_REFERENCE" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="PRIX" class="java.lang.Double"/>
	<field name="DSC_LABEL" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="80" splitType="Stretch">
			<image>
				<reportElement x="0" y="0" width="200" height="80" uuid="b75a065c-a50a-4c1d-997d-82402290cff2"/>
				<imageExpression><![CDATA[this.getClass().getClassLoader().getResourceAsStream("jasper/img/logo.png")]]></imageExpression>
			</image>
			<textField>
				<reportElement x="500" y="20" width="55" height="20" uuid="643dd695-8730-4a89-856f-2631b2bb3bd2"/>
				<textElement>
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PRO_REFERENCE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="500" y="0" width="55" height="20" uuid="20163923-2480-4efd-aea6-090af66e8a34"/>
				<textElement>
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SAL_MAND_REFERENCE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="424" y="0" width="74" height="20" uuid="e4f1fa81-79d1-497a-89f7-ae55b3257861"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="12"/>
				</textElement>
				<text><![CDATA[Mandat : ]]></text>
			</staticText>
			<staticText>
				<reportElement x="424" y="20" width="74" height="20" uuid="81b1d9be-8050-4744-9c89-956c52d8502c"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="12"/>
				</textElement>
				<text><![CDATA[Référence : ]]></text>
			</staticText>
		</band>
	</title>
	<detail>
		<band height="496" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement mode="Transparent" x="0" y="0" width="554" height="42" forecolor="#990099" uuid="85e24f5c-1421-4301-92b6-9718f73206c7"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="32"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ADD_CITY}]]></textFieldExpression>
			</textField>
			<subreport>
				<reportElement mode="Transparent" x="0" y="104" width="250" height="155" uuid="7e1b69f6-7ccb-4d0c-80f1-8b0516a214ce"/>
				<subreportParameter name="DOC_DIR">
					<subreportParameterExpression><![CDATA[$P{DOC_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="reference">
					<subreportParameterExpression><![CDATA[$P{reference}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "classeur_photos.jasper"]]></subreportExpression>
			</subreport>
			<textField isStretchWithOverflow="true" pattern="#,##0">
				<reportElement x="401" y="46" width="136" height="35" forecolor="#990099" uuid="1d7e39de-3f75-4423-b2e3-3d222991c81e"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="28" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PRIX}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="310" y="81" width="245" height="20" forecolor="#990099" uuid="32326030-2c95-42ab-a3f8-d1d68179421f"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Frais d'agence inclus à la charge du vendeur]]></text>
			</staticText>
			<staticText>
				<reportElement x="537" y="46" width="18" height="35" forecolor="#990099" uuid="2d7cd6c3-4432-4769-901a-18b7382c9150"/>
				<textElement>
					<font fontName="Arial" size="28" isBold="true"/>
				</textElement>
				<text><![CDATA[€]]></text>
			</staticText>
			<frame>
				<reportElement mode="Transparent" x="299" y="104" width="255" height="165" forecolor="#00FF66" backcolor="#66CC00" uuid="56f3b6f4-5922-474d-91a5-2dc6c2b9dfcd"/>
				<box>
					<pen lineWidth="0.25" lineColor="#990099"/>
					<topPen lineWidth="0.25" lineColor="#990099"/>
					<leftPen lineWidth="0.25" lineColor="#990099"/>
					<bottomPen lineWidth="0.25" lineColor="#990099"/>
					<rightPen lineWidth="0.25" lineColor="#990099"/>
				</box>
				<textField>
					<reportElement x="11" y="12" width="227" height="143" uuid="2805154b-3c5a-4ce2-b5a4-01dc4413c1eb"/>
					<textElement>
						<font fontName="Cambria" size="12"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{DSC_LABEL}.replaceAll("->","\u21E8")]]></textFieldExpression>
				</textField>
			</frame>
		</band>
	</detail>
	<lastPageFooter>
		<band height="50"/>
	</lastPageFooter>
</jasperReport>
